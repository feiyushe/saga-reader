{
  "data": {
    "code_dossier": {
      "name": "llm_processor.rs",
      "file_path": "crates/intelligent/src/article_processor/llm_processor.rs",
      "code_purpose": "agent",
      "importance_score": 0.8,
      "description": "基于LLM的文章处理器，通过CompletionAgent与大模型交互，执行文章内容的智能处理和转换。",
      "functions": [
        "new",
        "process"
      ],
      "interfaces": [
        "IArticleProcessor",
        "IPresetArticleLLMProcessor"
      ]
    },
    "detailed_description": "该组件是一个智能Agent，负责利用大语言模型（LLM）对文章内容进行处理。它封装了CompletionAgent实例，并通过用户指令提示词（user_prompt_command）构造完整的对话上下文，调用LLM生成改写后的内容。支持根据系统或指定语言设置输出语种，适用于多语言场景下的内容智能化处理任务。",
    "responsibilities": [
      "作为LLM驱动的文章处理核心Agent",
      "实现IArticleProcessor接口以支持统一调度流程",
      "构建包含原文、指令和语言要求的完整prompt用于LLM交互",
      "管理CompletionAgent生命周期并执行异步内容生成",
      "处理多语言需求，自动识别系统locale或使用指定语言"
    ],
    "interfaces": [
      {
        "name": "IArticleProcessor",
        "interface_type": "trait",
        "visibility": "public",
        "parameters": [],
        "return_type": null,
        "description": "文章处理器通用接口，定义process方法用于处理文章"
      },
      {
        "name": "IPresetArticleLLMProcessor",
        "interface_type": "trait",
        "visibility": "public",
        "parameters": [
          {
            "name": "llm_section",
            "param_type": "LLMSection",
            "is_optional": false,
            "description": "LLM配置节"
          }
        ],
        "return_type": "anyhow::Result<ArticleLLMProcessor>",
        "description": "预设处理器创建trait，用于工厂模式初始化处理器实例"
      },
      {
        "name": "process",
        "interface_type": "method",
        "visibility": "public",
        "parameters": [
          {
            "name": "input",
            "param_type": "&Article",
            "is_optional": false,
            "description": null
          },
          {
            "name": "opt",
            "param_type": "LLMInstructOption",
            "is_optional": false,
            "description": null
          }
        ],
        "return_type": "anyhow::Result<Article>",
        "description": "异步处理输入文章并返回结果"
      },
      {
        "name": "new",
        "interface_type": "constructor",
        "visibility": "public",
        "parameters": [
          {
            "name": "llm_section",
            "param_type": "LLMSection",
            "is_optional": false,
            "description": null
          },
          {
            "name": "system_prompt",
            "param_type": "String",
            "is_optional": false,
            "description": null
          },
          {
            "name": "user_prompt_command",
            "param_type": "String",
            "is_optional": false,
            "description": null
          },
          {
            "name": "options",
            "param_type": "AITargetOption",
            "is_optional": false,
            "description": null
          }
        ],
        "return_type": "anyhow::Result<Self>",
        "description": "构造新的ArticleLLMProcessor实例"
      }
    ],
    "dependencies": [
      {
        "name": "llm::llm_agent::CompletionAgent",
        "path": "llm::llm_agent::CompletionAgent",
        "is_external": false,
        "line_number": 1,
        "dependency_type": "struct",
        "version": null
      },
      {
        "name": "llm::providers::types::AITargetOption",
        "path": "llm::providers::types::AITargetOption",
        "is_external": false,
        "line_number": 2,
        "dependency_type": "type",
        "version": null
      },
      {
        "name": "types::Article",
        "path": "types::Article",
        "is_external": false,
        "line_number": 3,
        "dependency_type": "struct",
        "version": null
      },
      {
        "name": "types::LLMInstructOption",
        "path": "types::LLMInstructOption",
        "is_external": false,
        "line_number": 3,
        "dependency_type": "struct",
        "version": null
      },
      {
        "name": "types::LLMSection",
        "path": "types::LLMSection",
        "is_external": false,
        "line_number": 3,
        "dependency_type": "struct",
        "version": null
      },
      {
        "name": "sys_locale::get_locale",
        "path": "sys_locale::get_locale",
        "is_external": false,
        "line_number": 5,
        "dependency_type": "function",
        "version": null
      }
    ],
    "complexity_metrics": {
      "cyclomatic_complexity": 3.0,
      "lines_of_code": 61,
      "number_of_functions": 2,
      "number_of_classes": 1,
      "depth_of_inheritance": 0,
      "coupling_factor": 0.6,
      "cohesion_score": 0.85
    }
  },
  "timestamp": 1758805375,
  "prompt_hash": "cca07707e11e5cc5c434ca48a0dd83e9",
  "token_usage": {
    "input_tokens": 1013,
    "output_tokens": 1102,
    "total_tokens": 2115
  },
  "model_name": null
}